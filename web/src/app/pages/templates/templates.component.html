<div class="flex min-h-full w-full">
  <div class="min-w-60">
    <div class="h-full min-w-96 border-r border-r-base-6">
      <ul class="flex flex-col gap-2.5 p-2.5" *ngFor="let template of templates()">
        <li>
          <app-template-list-item
            [selected]="template.id == selectedTemplate()?.id"
            (templateEmitter)="receiveTemplate($event)"
            [template]="template"
          />
        </li>
      </ul>

      <button
        (click)="onNewTemplate()"
        class="fixed bottom-6 m-2.5 mx-5 grid size-12 place-items-center rounded-full bg-[#4d537b] text-white transition-all hover:bg-primary-blue-1 active:scale-[90%] disabled:bg-gray-500"
        [disabled]="!roleService.isAdmin()"
      >
        <lucide-icon name="plus-icon"></lucide-icon>
      </button>
    </div>
  </div>

  <div class="mx-auto mt-5 flex h-screen w-full max-w-2xl flex-col gap-2">
    @if (selectedTemplate()) {
      <div class="flex items-center justify-between">
        <div>
          <label for="header" class="mb-1 text-sm font-semibold">Title</label>
          <input
            id="header"
            class="font-xl mb-2 w-full min-w-96 rounded-md border-2 px-2 py-1"
            [(ngModel)]="templateHeader"
            [disabled]="!roleService.isAdmin()"
          />
        </div>
        <button
          class="flex h-min items-center justify-center gap-2 rounded-lg bg-primary-blue-1 px-3 py-2 font-semibold text-white transition-all enabled:hover:bg-primary-blue-1/85 enabled:active:scale-[98%] disabled:bg-gray-500"
          (click)="onSave()"
          [disabled]="!roleService.isAdmin()"
        >
          <lucide-icon name="save" class="h-4 w-4 text-white" />
          Save
        </button>
      </div>
      <div class="flex flex-col gap-1">
        <label for="platform" class="text-sm font-semibold">Platform</label>
        <select [(ngModel)]="selectedPlatform" id="platform" class="rounded-md border-2 px-2 py-1" [disabled]="!roleService.isAdmin()">
          <option *ngFor="let platform of platforms" [value]="platform">{{ platform }}</option>
        </select>
      </div>

      <hr class="my-4 w-full border-b border-b-black/10" />

      <div>
        <label for="editor" class="mb-1 text-sm font-semibold">Template</label>

        <mat-select id="language" [(value)]="selectedLanguage" (valueChange)="onDisplay()" class="rounded-md border-2 px-2 py-1">
          @for (translation of selectedTemplate()?.translations; track $index) {
            <mat-option [value]="translation.language">{{ translation.language }}</mat-option>
          }
          @if (roleService.isAdmin()) {
            <mat-option (click)="newLanguage()">new language</mat-option>
          }
        </mat-select>
        <div class="mt-3 overflow-hidden rounded-md border border-gray-300">
          <div class="flex gap-1.5 p-1.5">
            <button
              (click)="insertIntoBody('username')"
              class="pressable rounded-md bg-primary-red-3/30 px-1 py-0.5 text-sm font-semibold text-primary-red-1"
              [disabled]="!roleService.isAdmin()"
            >
              username
            </button>
            <button
              (click)="insertIntoBody('fullname')"
              class="pressable rounded-md bg-primary-red-3/30 px-1 py-0.5 text-sm font-semibold text-primary-red-1"
              [disabled]="!roleService.isAdmin()"
            >
              fullname
            </button>
          </div>
          <hr />
          <ngx-editor
            id="editor"
            [editor]="editor"
            [(ngModel)]="templateBody"
            (ngModelChange)="onTextChanged()"
            [disabled]="false"
            [placeholder]="'Type here...'"
            style="--ngx-editor-border-color: white"
            [disabled]="!roleService.isAdmin()"
          />
        </div>
      </div>
    } @else {
      <div class="grid place-items-center"><h1 class="mt-96 text-3xl font-bold opacity-40">Please select a Template</h1></div>
    }
  </div>
</div>
